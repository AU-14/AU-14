# Constructs

- type: entity
  abstract: true
  id: BaseXenoConstruct
  components:
  # TODO: RCM14 start a cooldown for making a new construct if destroyed, if that is actually how it works in cm13. afaict it's a global cooldown with hivecore thats it
  - type: Physics
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeAabb
          bounds: "-0.49,-0.49,0.49,0.49"
        layer:
        - BulletImpassable
        density: 200
  - type: Transform
    anchored: true
  - type: HiveMember
  - type: InteractionOutline
  - type: Clickable
  - type: Damageable
    damageContainer: StructuralXeno
    damageModifierSet: Resin

- type: entity
  parent: BaseXenoConstruct
  id: HiveCoreXeno
  name: hive core
  description: A giant pulsating mound of mass. It looks very much alive.
  components: 
  - type: Sprite
    sprite: _RMC14/Structures/Xenos/hive_core.rsi
    state: core
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 1200
      behaviors:
      - !type:DoActsBehavior
        acts: ["Destruction"]
  - type: RMCNightVisionVisible
    priority: -1
    transparency: 0.2
  - type: HiveCore
  - type: GhostRole
    name: roles-lesser-drone-name
    description: roles-lesser-drone-description
  - type: GhostRoleMobSpawner
    availableTakeovers: 2
    deleteOnSpawn: false
    prototype: CMXenoLesserDrone
  - type: HiveConstructionUnique
    id: HiveCoreXeno
  - type: WarpPoint
    location: hive core
  - type: RoofingEntity
    range: 10
  #- type: ModifyHiveLimits
    #construction:
      #HiveClusterXeno: 8
      # TODO RMC14 other structures wyci

- type: entity
  parent: BaseXenoConstruct
  id: HiveClusterXeno
  name: hive cluster
  description: A large clump of gooey mass. It rhythmically pulses, as if its pumping something into the weeds below...
  components:
  - type: Sprite
    sprite: _RMC14/Structures/Xenos/hive_cluster.rsi
    state: cluster
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 1200
      behaviors:
      - !type:DoActsBehavior
        acts: ["Destruction"]
  # TODO: repair with plasma over 4 seconds, removes damage and respawns weeds after 15 seconds?
  - type: HiveCluster
  - type: HiveConstructionUnique
    id: HiveClusterXeno

# Construction nodes

- type: entity
  abstract: true
  parent: BaseXenoConstruct
  id: BaseXenoConstructionNode
  description: A strange wriggling lump. Looks like a marker for something.
  suffix: Construction
  components:
  - type: Sprite
    color: '#FFFFFFAA'
  - type: HiveConstructionNode

- type: entity
  parent: BaseXenoConstructionNode
  id: HiveCoreXenoConstructionNode
  name: hive core
  components:
  - type: Sprite
    sprite: _RMC14/Structures/Xenos/hive_core.rsi
    state: core
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 300 # TODO RMC14
      behaviors:
      - !type:DoActsBehavior
        acts: ["Destruction"]
  - type: RMCNightVisionVisible
    priority: -1
    transparency: 0.1
  - type: HiveConstructionNode
    plasmaCost: 1000
    spawn: HiveCoreXeno
