- type: entity
  abstract: true
  parent: CMAttachmentBase
  id: CMUnderAttachmentBase
  components:
  - type: Sprite
    sprite: _RMC14/Objects/Weapons/Guns/Attachments/under.rsi
  - type: Tag
    tags:
    - CMAttachmentUnderbarrel

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentAngledGrip
  name: angled grip
  description: "An angled foregrip that improves weapon ergonomics resulting in faster wielding time.
    However, it also increases weapon size."
  components:
  - type: Sprite
    state: angledgrip

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentBipod
  name: bipod
  description: "A simple set of telescopic poles to keep a weapon stabilized during firing.
    Greatly increases accuracy and reduces recoil when properly placed, but also increases weapon size and slows firing speed."
  components:
  - type: Sprite
    state: bipod

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentBurstFireAssembly
  name: burst fire assembly
  description: "A small angled piece of fine machinery that increases the burst count on some weapons, and grants the ability to others.
    Increases weapon scatter."
  components:
  - type: Sprite
    state: rapidfire

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentGyroscopicStabilizer
  name: gyroscopic stabilizer
  description: A set of weights and balances to stabilize the weapon when fired with one hand. Slightly decreases firing speed.
  components:
  - type: Sprite
    state: gyro

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentLaserSight
  name: laser sight
  description: A laser sight that attaches to the underside of most weapons. Increases accuracy and decreases scatter, especially while one-handed.
  components:
  - type: Sprite
    state: lasersight

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentMiniFlamethrower
  name: mini flamethrower
  description: A weapon-mounted refillable flamethrower attachment. It has a secondary setting for a more intense flame with far less propulsion ability and heavy fuel usage.
  components:
  - type: Sprite
    state: flamethrower

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentXMVESG1FlamerNozzle
  name: XM-VESG-1 flamer nozzle
  description: A special nozzle designed to alter flamethrowers to be used in a more offense orientated manner. As the inside of the nozzle is coated in a special gel and resin substance that takes the fuel that passes through and hardens it. Upon exiting the barrel, a cluster of burning gel is projected instead of a stream of burning naphtha.
  components:
  - type: Sprite
    state: flamer_nozzle

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentU7UnderbarrelShotgun
  name: U7 underbarrel shotgun
  description: An AEGIS U7 tactical shotgun. Attaches to the underbarrel of most weapons. Only capable of loading up to five buckshot shells. Specialized for breaching into buildings.
  components:
  - type: Sprite
    state: masterkey
  - type: Tag
    tags:
    - CMAttachmentUnderbarrel
    - CMAttachmentU7UnderbarrelShotgun
  - type: Gun
    soundGunshot:
      path: /Audio/_RMC14/Weapons/Guns/Gunshots/gun_shotgun_u7.ogg
      params:
        volume: -2
  - type: ContainerContainer
    containers:
      ballistic-ammo: !type:Container
  - type: BallisticAmmoProvider
    cycleable: false
    whitelist:
      tags:
      - CMShellShotgun
    capacity: 5
    proto: null
    soundInsert:
      path: /Audio/_RMC14/Weapons/Guns/Reload/m42a2.ogg
  - type: UniqueAction
  - type: PumpAction
  - type: ShootUseDelay
    delay: 2.1
  - type: UseDelay
  - type: AttachableToggleable
    attachedOnly: true
    supercedeHolder: true
    activateSound:
      path: /Audio/_RMC14/Attachable/gun_u7_activate.ogg
      params:
        volume: -2
    actionName: U7 underbarrel shotgun
    actionDesc: Switch to using the underbarrel shotgun.
    icon:
      sprite: _RMC14/Objects/Weapons/Guns/Attachments/under.rsi
      state: masterkey
    iconActive:
      sprite: _RMC14/Objects/Weapons/Guns/Attachments/under.rsi
      state: masterkey-on
  - type: AttachableVisuals

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentUnderbarrelExtinguisher
  name: HME-12 underbarrel extinguisher
  description: A Taiho-Technologies HME-12 underbarrel extinguisher. Attaches to the underbarrel of most weapons. Point at flame before applying pressure.
  components:
  - type: Sprite
    state: extinguisher

- type: entity
  parent: CMUnderAttachmentBase
  id: RMCAttachmentU1GrenadeLauncher
  name: U1 grenade launcher
  description: A weapon-mounted, reloadable grenade launcher.
  components:
  - type: Sprite
    layers:
      - state: grenade
        map: [ "enum.BreechVisuals.Open" ]
    state: masterkey
  - type: AmmoCounter
  - type: Gun
    soundGunshot:
      path: /Audio/_RMC14/Weapons/Guns/Gunshots/gun_ugl.ogg
    resetOnHandSelected: false
  - type: BallisticAmmoProvider
    cycleable: false
    whitelist:
      tags:
      - RMCGrenadeM40
    capacity: 3
    soundInsert:
      path: /Audio/_RMC14/Weapons/Guns/Reload/grenade_insert.ogg
      params:
        volume: -2
  - type: OnShootTriggerAmmoTimer
    delay: 1
    beepInterval: 2
    initialBeepDelay: 0
    beepSound:
      path: "/Audio/Effects/beep1.ogg"
      params:
        volume: 5
  - type: AmmoFixedDistance
  - type: ShootUseDelay
    delay: 2.4
  - type: UseDelay
  - type: UniqueAction
  - type: BreechLoaded
    needOpenClose: true
  - type: Appearance
  - type: GenericVisualizer
    visuals:
      enum.BreechVisuals.Open:
        enum.BreechVisuals.Open:
          True: { state: grenade-open }
          False: { state: grenade }
  - type: AttachableToggleable
    attachedOnly: true
    supercedeHolder: true
    actionName: U1 grenade launcher
    actionDesc: Switch to using the underbarrel grenade launcher.
    icon:
      sprite: _RMC14/Objects/Weapons/Guns/Attachments/under.rsi
      state: grenade
    iconActive:
      sprite: _RMC14/Objects/Weapons/Guns/Attachments/under.rsi
      state: grenade-on
  - type: AttachableVisuals
    redrawOnAppearanceChange: true
  - type: Tag
    tags:
    - RMCAttachmentU1GrenadeLauncher

- type: entity
  parent: CMUnderAttachmentBase
  id: CMAttachmentVerticalGrip
  name: vertical grip
  description: A vertical foregrip that offers better accuracy, less recoil, and less scatter, especially during burst fire. \nHowever, it also increases weapon size.
  components:
  - type: Sprite
    state: verticalgrip

- type: Tag
  id: CMAttachmentUnderbarrel

- type: Tag
  id: CMAttachmentU7UnderbarrelShotgun

- type: Tag
  id: RMCAttachmentU1GrenadeLauncher
